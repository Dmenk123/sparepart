var save_method,table;function filter_tabel(){var a=$("#tgl_filter_mulai").val(),e=$("#tgl_filter_akhir").val(),t=$("#status_filter").val();table=$("#tabel_confirm_jual").DataTable({destroy:!0,responsive:!0,searchDelay:500,processing:!0,serverSide:!0,ajax:{url:base_url+"confirm_jual/list_penjualan",type:"POST",data:{tgl_awal:a,tgl_akhir:e,status:t},dataType:"JSON"},columnDefs:[{targets:[-1],orderable:!1}]})}function add_menu(){reset_modal_form(),save_method="add",$("#modal_user_form").modal("show"),$("#modal_title").text("Tambah User Baru")}function edit_user(a){reset_modal_form(),save_method="update",$.ajax({url:base_url+"master_user/edit_user",type:"POST",dataType:"JSON",data:{id:a},success:function(a){$("#div_pass_lama").css("display","block"),$("#div_preview_foto").css("display","block"),$("#div_skip_password").css("display","block"),$('[name="id_user"]').val(a.old_data.id),$('[name="username"]').val(a.old_data.username).attr("disabled",!0),$('[name="role"]').val(a.old_data.id_role),$('[name="status"]').val(a.old_data.status),$("#preview_img").attr("src","data:image/jpeg;base64,"+a.foto_encoded),$("#modal_user_form").modal("show"),$("#modal_title").text("Edit User")},error:function(a,e,t){alert("Error get data from ajax")}})}function reload_table(){table.ajax.reload(null,!1)}function konfirmasi_penjualan(){var a=$("#form-konfirmasi")[0],e=new FormData(a),a=CKEDITOR.instances.pesan_email.getData();e.append("pesan_email",a),$("#btn_confirm").prop("disabled",!0),$("#btn_confirm").text("Menyimpan Data"),$.ajax({type:"POST",enctype:"multipart/form-data",url:base_url+"confirm_jual/konfirmasi_penjualan",data:e,dataType:"JSON",processData:!1,contentType:!1,cache:!1,timeout:6e5,success:function(a){if(a.status)swal.fire("Sukses!!","Konfirmasi Berhasil","success"),$("#btn_confirm").prop("disabled",!1),$("#btn_confirm").text("Konfirmasi"),window.location=base_url+"confirm_jual";else{if(a.err)swal.fire("Gagal!!","Terjadi Kesalahan","warning");else for(var e=0;e<a.inputerror.length;e++)$('[name="'+a.inputerror[e]+'"]').next().next().text(a.error_string[e]).addClass("invalid-feedback-select");$("#btn_confirm").prop("disabled",!1),$("#btn_confirm").text("Konfirmasi")}},error:function(a){console.log("ERROR : ",a),$("#btn_confirm").prop("disabled",!1),$("#btn_confirm").text("Konfirmasi"),reset_modal_form(),$(".modal").modal("hide")}})}function set_failure(e){swalConfirmDelete.fire({title:"Set Ke Failure ?",text:"Data Akan Diset ke Failure ?",type:"warning",showCancelButton:!0,confirmButtonText:"Ya, Lakukan !",cancelButtonText:"Tidak, Batalkan!",reverseButtons:!0}).then(a=>{a.value?$.ajax({url:base_url+"confirm_jual/set_failure",type:"POST",dataType:"JSON",data:{id:e},success:function(a){swalConfirm.fire("Berhasil !","Berhasil Set Failure","success"),table.ajax.reload()},error:function(a,e,t){Swal.fire("Terjadi Kesalahan")}}):a.dismiss===Swal.DismissReason.cancel&&swalConfirm.fire("Dibatalkan","Aksi Dibatalakan","error")})}function readURL(a){var e;a.files&&a.files[0]?((e=new FileReader).onload=function(a){$("#div_preview_foto").css("display","block"),$("#preview_img").attr("src",a.target.result)},e.readAsDataURL(a.files[0])):($("#div_preview_foto").css("display","none"),$("#preview_img").attr("src",""))}function update_trans(e){swalConfirmDelete.fire({title:"Ubah Ingin Mengupdate Data ?",text:"Apakah Anda Yakin ?",type:"warning",showCancelButton:!0,confirmButtonText:"Ya, !",cancelButtonText:"Tidak, !",reverseButtons:!0}).then(a=>{a.value?$.ajax({url:base_url+"../transaction/status",type:"POST",dataType:"JSON",data:{order_id:e},success:function(a){swalConfirm.fire("Berhasil !",a.pesan,"success"),table.ajax.reload()},error:function(a,e,t){Swal.fire("Terjadi Kesalahan")}}):a.dismiss===Swal.DismissReason.cancel&&swalConfirm.fire("Dibatalkan","Aksi Dibatalakan","error")})}function ekspor_excel(){var a=$("#tgl_filter_mulai").val(),e=$("#tgl_filter_akhir").val(),t=$("#status_filter").val();window.open(base_url+"confirm_jual/export_excel?tgl_awal="+a+"&tgl_akhir="+e+"&status="+t,"_blank")}$(document).ready(function(){filter_tabel(),$("#pesan_email").ckeditor(),$("input.numberinput").bind("keypress",function(a){return 8==a.which||0==a.which||!(a.which<48||57<a.which)||46==a.which}),$("#foto").change(function(){readURL(this)}),$(document).on("click",".btn_edit_status",function(){var e=$(this).attr("id"),t=$(this).val();swalConfirm.fire({title:"Ubah Status Data User ?",text:"Apakah Anda Yakin ?",icon:"warning",showCancelButton:!0,confirmButtonText:"Ya, Ubah Status!",cancelButtonText:"Tidak, Batalkan!",reverseButtons:!0}).then(a=>{a.value?$.ajax({url:base_url+"master_user/edit_status_user/"+e,type:"POST",dataType:"JSON",data:{status:t},success:function(a){swalConfirm.fire("Berhasil Ubah Status User!",a.pesan,"success"),table.ajax.reload()},error:function(a,e,t){Swal.fire("Terjadi Kesalahan")}}):a.dismiss===Swal.DismissReason.cancel&&swalConfirm.fire("Dibatalkan","Aksi Dibatalakan","error")})}),$(".modal").on("hidden.bs.modal",function(){reset_modal_form(),reset_modal_form_import()})});